<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="IDHEXMobApp.Views.PedidosBaixaPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:model="clr-namespace:IDHEXMobApp.Models.Response"
    xmlns:viewModel="clr-namespace:IDHEXMobApp.ViewModels"
    Title="Pedidos Baixa"
    x:DataType="viewModel:PedidosBaixaViewModel"
    BackgroundColor="{StaticResource White}">


    <ContentPage.Resources>
        <Style TargetType="BoxView">
            <Setter Property="Color" Value="Gray" />
            <Setter Property="HeightRequest" Value="1" />
        </Style>
    </ContentPage.Resources>

    <Grid RowDefinitions="*, 70">
        <Button
            Grid.Row="0"
            Margin="10,10,10,10"
            Command="{Binding GoToBaixarCommand}"
            FontAttributes="Bold"
            Style="{StaticResource ButtonOutline}"
            Text="BAIXAR TODOS"
            VerticalOptions="Start" />
        
        <CollectionView
            Margin="8,60,0,0"
            EmptyView="Nenhum item encontrado"
            ItemsSource="{Binding Pedidos}">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Border
                        Margin="10,5,15,0"
                        Padding="0"
                        BackgroundColor="WhiteSmoke"
                        Stroke="Gray"
                        StrokeShape="RoundRectangle 5"
                        StrokeThickness="1">
                        <StackLayout
                            Padding="4"
                            x:DataType="model:PedidoResponse"
                            Orientation="Vertical">
                            <Label
                                Grid.Row="1"
                                Grid.ColumnSpan="3"
                                BackgroundColor="LightGray"
                                FontAttributes="Bold"
                                FontSize="Medium"
                                HorizontalOptions="Start"
                                HorizontalTextAlignment="Center"
                                Text="{Binding Nome}"
                                TextColor="Black" />
                            <Label
                                Grid.Column="2"
                                Text="{Binding NumNotaFiscal, StringFormat='Nota Fiscal: {0}'}"
                                TextColor="Black" />
                            <Label Text="{Binding NomeTomador, StringFormat='Destinatário: {0}'}" TextColor="Black" />
                            <Label Text="{Binding CNPJ, StringFormat='CNPJ: {0}'}" TextColor="Black" />
                            <Label
                                Grid.ColumnSpan="2"
                                Text="{Binding Endereco, StringFormat='Endereço: {0}'}"
                                TextColor="Black" />
                            <Label
                                Grid.Column="1"
                                HorizontalOptions="Start"
                                Text="{Binding NumRomaneio, StringFormat='Romaneio: {0}'}"
                                TextColor="Black" />
                            <Label
                                Grid.Column="2"
                                HorizontalOptions="Start"
                                Text="{Binding VlrNotaFiscal, StringFormat='Valor: R$ {0:F2}'}"
                                TextColor="Red" />

                        </StackLayout>
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
        <Border
            Grid.Row="1"
            Margin="10"
            Padding="10,15"
            BackgroundColor="LightGray"
            StrokeShape="RoundRectangle 30"
            StrokeThickness="1"
            VerticalOptions="End">
            <Grid ColumnDefinitions="*, Auto" RowDefinitions="Auto, Auto">
                <Label
                    Grid.Row="3"
                    Margin="10,0"
                    FontAttributes="Bold"
                    FontSize="12"
                    Text="{Binding Pendentes, Mode=TwoWay}"
                    TextColor="Black" />

            </Grid>
        </Border>
        <ActivityIndicator
            Grid.RowSpan="2"
            Grid.ColumnSpan="2"
            HorizontalOptions="Fill"
            IsEnabled="{Binding IsBusy}"
            IsRunning="{Binding IsBusy}"
            IsVisible="{Binding IsBusy}"
            VerticalOptions="Center"
            Color="{StaticResource Primary}" />
    </Grid>

</ContentPage>